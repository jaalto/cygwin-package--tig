--- tig-0.13.orig/debian/rules
+++ tig-0.13/debian/rules
@@ -0,0 +1,87 @@
+#!/usr/bin/make -f
+# debian/rules for tig
+#
+# Written by Sebastian Harl <sh@tokkee.org>
+
+# Uncomment this to turn on verbose mode.
+#export DH_VERBOSE=1
+
+# These are used for cross-compiling and for saving the configure script
+# from having to guess our platform (since we know it already)
+DEB_HOST_GNU_TYPE   ?= $(shell dpkg-architecture -qDEB_HOST_GNU_TYPE)
+DEB_BUILD_GNU_TYPE  ?= $(shell dpkg-architecture -qDEB_BUILD_GNU_TYPE)
+
+CFLAGS = -Wall -g
+
+ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
+	CFLAGS += -O0
+else
+	CFLAGS += -O2
+endif
+
+include /usr/share/dpatch/dpatch.make
+
+config.status: configure
+	dh_testdir
+	./configure --host=$(DEB_HOST_GNU_TYPE) --build=$(DEB_BUILD_GNU_TYPE) \
+		--prefix=/usr --mandir=\$${prefix}/share/man --sysconfdir=/etc \
+		CFLAGS="$(CFLAGS)"
+
+build: build-stamp
+
+build-stamp: config.status $(DPATCH_STAMPFN)
+	dh_testdir
+	
+	$(MAKE) all doc
+	
+	touch build-stamp
+
+clean: unpatch
+	dh_testdir
+	dh_testroot
+	rm -f build-stamp
+	
+	$(MAKE) clean
+	
+	rm -f config.h config.log config.make config.status
+	rm -rf manual.html-chunked/
+	rm -f manual.pdf manual.html manual.toc
+	rm -f tig.1 tig.1.html tigrc.5 tigrc.5.html
+	rm -f NEWS.html README.html
+	
+	dh_clean 
+
+install: build
+	dh_testdir
+	dh_testroot
+	dh_clean -k
+	dh_installdirs
+	
+	$(MAKE) install install-doc DESTDIR=$(CURDIR)/debian/tig
+	
+	mkdir -p debian/tig/etc/bash_completion.d
+	cp contrib/tig-completion.bash debian/tig/etc/bash_completion.d/tig
+	chmod 644 debian/tig/etc/bash_completion.d/tig
+
+binary-indep:
+	# nothing to do here
+
+binary-arch: build install
+	dh_testdir
+	dh_testroot
+	dh_installchangelogs
+	dh_installdocs NEWS BUGS TODO manual.pdf
+	dh_installexamples contrib/tigrc
+	dh_link
+	dh_strip
+	dh_compress -X.pdf
+	dh_fixperms
+	dh_installdeb
+	dh_shlibdeps
+	dh_gencontrol
+	dh_md5sums
+	dh_builddeb
+
+binary: binary-indep binary-arch
+.PHONY: build clean binary-indep binary-arch binary install patch unpatch
+
--- tig-0.13.orig/debian/watch
+++ tig-0.13/debian/watch
@@ -0,0 +1,3 @@
+version=3
+http://jonas.nitro.dk/tig/releases/ tig-(.*)\.tar\.gz
+
--- tig-0.13.orig/debian/control
+++ tig-0.13/debian/control
@@ -0,0 +1,27 @@
+Source: tig
+Section: utils
+Priority: optional
+Maintainer: Sebastian Harl <sh@tokkee.org>
+Build-Depends: debhelper (>= 5), dpatch, dpkg-dev (>= 1.14.6), git-core, libncursesw5-dev, asciidoc (>= 7), xmlto, docbook-utils
+Standards-Version: 3.8.0
+Homepage: http://jonas.nitro.dk/tig/
+Vcs-Git: git://git.tokkee.org/pkg-tig.git
+Vcs-Browser: http://git.tokkee.org/?p=pkg-tig.git
+
+Package: tig
+Architecture: any
+Depends: git-core (>= 1.5.4), ${shlibs:Depends}
+Description: ncurses-based Git repository browser
+ This package contains a text-mode interface for the version control system
+ Git. It may be used to browse the history and contents of a repository.
+ .
+ The following main features are supported:
+  - View revision logs, commit messages, diffstats, diffs, archive trees and
+    file contents.
+  - Visualize revision graphs.
+  - Stage / unstage changes and add untracked files.
+  - Merge files.
+  - Cherry-pick commits.
+ .
+ tig may also be used as a pager. It reads input from stdin and colorizes it.
+
--- tig-0.13.orig/debian/copyright
+++ tig-0.13/debian/copyright
@@ -0,0 +1,35 @@
+This package was debianized by Sebastian Harl <sh@tokkee.org> on
+Thu, 28 Sep 2006 13:09:36 +0200.
+
+It was downloaded from <http://jonas.nitro.dk/tig/releases/>.
+
+Upstream Author:
+	Jonas Fonseca <fonseca@diku.dk>
+
+Copyright Holder:
+	Jonas Fonseca <fonseca@diku.dk>
+
+License:
+
+	Copyright © 2006-2009 Jonas Fonseca <fonseca@diku.dk>
+
+	This package is free software; you can redistribute it and/or modify
+	it under the terms of the GNU General Public License as published by
+	the Free Software Foundation; either version 2 of the License, or
+	(at your option) any later version.
+
+	This package is distributed in the hope that it will be useful,
+	but WITHOUT ANY WARRANTY; without even the implied warranty of
+	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+	GNU General Public License for more details.
+
+	You should have received a copy of the GNU General Public License
+	along with this package; if not, write to the Free Software
+	Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
+
+On Debian systems, the complete text of the GNU General Public License 
+can be found in `/usr/share/common-licenses/GPL'.
+
+The Debian packaging is © 2006-2009, Sebastian Harl <sh@tokkee.org> and
+is licensed under the GPL, see above.
+
--- tig-0.13.orig/debian/compat
+++ tig-0.13/debian/compat
@@ -0,0 +1 @@
+5
--- tig-0.13.orig/debian/changelog
+++ tig-0.13/debian/changelog
@@ -0,0 +1,120 @@
+tig (0.13-1) experimental; urgency=low
+
+  * New upstream release (Closes: #513727).
+  * debian/copyright: Use © instead of (C) to make lintian happy.
+  * debian/patches:
+    - Added non-utf8-fix.dpatch - upstream patch fixing a regression in the
+      handling of non-UTF-8 locales.
+    - Added tigrc-parsing-fix.dpatch - upstream patch fixing a regression in
+      parsing ~/.tigrc.
+    - Added mem-corruption-fix.dpatch - upstream patch fixing memory
+      corruption when updating the tree view.
+  * debian/rules:
+    - Remove auto-generated NEWS.html and README.html in the clean target.
+
+ -- Sebastian Harl <sh@tokkee.org>  Tue, 03 Feb 2009 10:59:25 +0100
+
+tig (0.12.1-1) experimental; urgency=low
+
+  * New upstream release.
+    - Added support for refreshing the main view (Closes: #498365).
+    - Disable boundary commits by default, fixing the behavior when using
+      options like --author=foo (Closes: #498628).
+  * Uploading to experimental because of Lenny freeze.
+  * debian/rules:
+    - Install upstream NEWS file to /usr/share/doc/tig/.
+    - No longer add -I/usr/include/ncursesw to CFLAGS - this is now handled by
+      the configure script.
+    - No longer pass LIBS="-lncursesw" to configure - this is now handled by
+      the configure script.
+  * debian/control:
+    - Depend on git-core >= 1.5.4 - this is required by the new upstream
+      release.
+    - Changed XS-Vcs-* to Vcs-*.
+
+ -- Sebastian Harl <sh@tokkee.org>  Sat, 11 Oct 2008 18:06:24 +0200
+
+tig (0.11-1) unstable; urgency=low
+
+  * New upstream release.
+  * Added git-core to the build dependencies (Closes: #481828).
+  * Updated standards-version to 3.8.0 - no changes.
+
+ -- Sebastian Harl <sh@tokkee.org>  Fri, 25 Jul 2008 07:47:37 +0200
+
+tig (0.10.1-1) unstable; urgency=low
+
+  * New upstream release.
+  * Moved "Homepage" field from package description to the source stanza.
+    - Added versioned build dependency on dpkg-dev (>= 1.14.6).
+  * Improved package description as suggested by Adeodato Simó
+    (Closes: #469290).
+  * Added wide character support, thanks to Cyril Brulebois for the patch
+    (Closes: #457068):
+    - Build-depend on libncursesw5-dev instead of libncurses5-dev.
+    - Pass "LIBS=-lncursesw" to configure.
+    - Added -I/usr/include/ncursesw to CFLAGS.
+  * Fixed a typo in debian/rules, preventing CFLAGS from being used, thanks to
+    Cyril Brulebois for the patch.
+  * Use the configure script provided by upstream.
+  * Updated standards-version to 3.7.3 - no changes.
+
+ -- Sebastian Harl <sh@tokkee.org>  Mon, 31 Mar 2008 12:57:05 +0200
+
+tig (0.9.1-1) unstable; urgency=low
+
+  * New upstream release.
+
+ -- Sebastian Harl <sh@tokkee.org>  Mon,  1 Oct 2007 15:07:38 +0200
+
+tig (0.9-1) unstable; urgency=low
+
+  * New upstream release.
+    - The manpage builds fine now (Closes: #434127).
+  * Install new bash completion script to /etc/bash_completion.d/.
+  * Adapted package description to the latest git-core package description.
+  * debian/rules: Do not ignore "make clean" error.
+
+ -- Sebastian Harl <sh@tokkee.org>  Sun, 23 Sep 2007 21:22:25 +0200
+
+tig (0.8-1) unstable; urgency=low
+
+  * New upstream release.
+    - Fixes segfault in pager mode (Closes: #429448).
+  * Added XS-Vcs-{Git,Browser} tags.
+
+ -- Sebastian Harl <sh@tokkee.org>  Tue, 19 Jun 2007 11:52:39 +0100
+
+tig (0.7-1) unstable; urgency=low
+
+  * New upstream release.
+    - Handle cursor keys in split pane mode correctly (Closes: #410394).
+  * Removed infiniteloop.dpatch - included in the new release.
+  * Removed splitview.dpatch - included in the new release.
+  * Removed v0.5.dpatch - included in the new release.
+
+ -- Sebastian Harl <sh@tokkee.org>  Mon,  4 Jun 2007 15:05:29 +0200
+
+tig (0.5-3) unstable; urgency=low
+
+  * Added upstream patch by Jonas Fonseca <fonseca@diku.dk> to update the
+    version string to 0.5 (Closes: #409095).
+  * Added watch file.
+
+ -- Sebastian Harl <sh@tokkee.org>  Thu,  1 Feb 2007 10:31:18 +0000
+
+tig (0.5-2) unstable; urgency=medium
+
+  * Added two upstream patches by Jonas Fonseca <fonseca@diku.dk>:
+    - Fix a segfault when navigating in tree mode (Closes: #403565).
+    - Fix an infinite loop.
+  * Put the sample manpage in /usr/share/doc/tig/examples/.
+
+ -- Sebastian Harl <sh@tokkee.org>  Fri, 22 Dec 2006 09:08:57 +0000
+
+tig (0.5-1) unstable; urgency=low
+
+  * Initial release (Closes: #389926).
+
+ -- Sebastian Harl <sh@tokkee.org>  Thu, 28 Sep 2006 13:09:36 +0200
+
--- tig-0.13.orig/debian/patches/tigrc-parsing-fix.dpatch
+++ tig-0.13/debian/patches/tigrc-parsing-fix.dpatch
@@ -0,0 +1,25 @@
+#! /bin/sh /usr/share/dpatch/dpatch-run
+## tigrc-parsing-fix.dpatch by Jonas Fonseca <fonseca@diku.dk>
+##
+## DP: Fix tokenizing when parsing ~/.tigrc
+## DP:
+## DP: When moving to use argv_from_string() in set_option() a regression was
+## DP: introduced causing problems with parsing of multiple spaces between
+## DP: arguments. For example:
+## DP:
+## DP: 	color date              yellow  default
+## DP:
+## DP: Reported by Clifford Caoile.
+
+diff a/tig.c b/tig.c
+--- a/tig.c
++++ b/tig.c
+@@ -292,7 +292,7 @@ argv_from_string(const char *argv[SIZEOF_ARG], int *argc, char *cmd)
+ 
+ 		cmd[valuelen] = 0;
+ 		argv[(*argc)++] = chomp_string(cmd);
+-		cmd += valuelen + advance;
++		cmd = chomp_string(cmd + valuelen + advance);
+ 	}
+ 
+ 	if (*argc < SIZEOF_ARG)
--- tig-0.13.orig/debian/patches/mem-corruption-fix.dpatch
+++ tig-0.13/debian/patches/mem-corruption-fix.dpatch
@@ -0,0 +1,60 @@
+#! /bin/sh /usr/share/dpatch/dpatch-run
+## mem-corruption-fix.dpatch by Jonas Fonseca <fonseca@diku.dk>
+##
+## DP: Fix memory corruption bug in tree_read when sorting the entries
+## DP:
+## DP: Triggered by defining ITEM_CHUNK_SIZE to 1.
+
+diff git a/tig.c b/tig.c
+--- a/tig.c
++++ b/tig.c
+@@ -3614,7 +3614,7 @@ static bool
+ {
+ 	size_t textlen = text ? strlen(text) : 0;
+ 	char buf[SIZEOF_STR];
+-	unsigned long pos;
++	size_t pos;
+ 	enum line_type type;
+ 	bool first_read = view->lines == 0;
+ 
+@@ -3645,8 +3645,12 @@ tree_read(struct view *view, char *text)
+ 			return FALSE;
+ 	}
+ 
++	if (!add_line_text(view, text, type))
++		return FALSE;
++	text = view->line[view->lines - 1].data;
++
+ 	/* Skip "Directory ..." and ".." line. */
+-	for (pos = 1 + !!*opt_path; pos < view->lines; pos++) {
++	for (pos = 1 + !!*opt_path; pos < view->lines - 1; pos++) {
+ 		struct line *line = &view->line[pos];
+ 		const char *path1 = tree_path(line);
+ 		char *path2 = text + SIZEOF_TREE_ATTR;
+@@ -3655,24 +3659,16 @@ tree_read(struct view *view, char *text)
+ 		if (cmp <= 0)
+ 			continue;
+ 
+-		text = strdup(text);
+-		if (!text)
+-			return FALSE;
+-
+-		if (view->lines > pos)
++		if (view->lines - 1 > pos)
+ 			memmove(&view->line[pos + 1], &view->line[pos],
+-				(view->lines - pos) * sizeof(*line));
++				(view->lines - 1 - pos) * sizeof(*line));
+ 
+ 		line = &view->line[pos];
+ 		line->data = text;
+ 		line->type = type;
+-		view->lines++;
+ 		return TRUE;
+ 	}
+ 
+-	if (!add_line_text(view, text, type))
+-		return FALSE;
+-
+ 	if (tree_lineno > view->lineno) {
+ 		view->lineno = tree_lineno;
+ 		tree_lineno = 0;
--- tig-0.13.orig/debian/patches/non-utf8-fix.dpatch
+++ tig-0.13/debian/patches/non-utf8-fix.dpatch
@@ -0,0 +1,26 @@
+#! /bin/sh /usr/share/dpatch/dpatch-run
+## non-utf8-fix.dpatch by Jonas Fonseca <fonseca@diku.dk>
+##
+## DP: Fix regression in handling of data for non-UTF-8 locales
+## DP:
+## DP: The bug was introduced in 65498141015b6070cf5c9b5704039389dba76e90 where
+## DP: the the IO API was changed from using stdio to 'raw' file descriptors.
+## DP: Part of the change removed the need for cutting the ending newline from
+## DP: the input line in update_view(). This caused the resulting iconv output
+## DP: buffer to not be NUL terminated since the input string no longer
+## DP: contained an ending NULL byte.
+## DP:
+## DP: Reported by Pavel Roskin.
+
+diff a/tig.c b/tig.c
+--- a/tig.c
++++ b/tig.c
+@@ -2707,7 +2707,7 @@ update_view(struct view *view)
+ 
+ 		if (opt_iconv != ICONV_NONE) {
+ 			ICONV_CONST char *inbuf = line;
+-			size_t inlen = linelen;
++			size_t inlen = linelen + 1;
+ 
+ 			char *outbuf = out_buffer;
+ 			size_t outlen = sizeof(out_buffer);
--- tig-0.13.orig/debian/patches/00list
+++ tig-0.13/debian/patches/00list
@@ -0,0 +1,4 @@
+non-utf8-fix.dpatch
+tigrc-parsing-fix.dpatch
+mem-corruption-fix.dpatch
+
